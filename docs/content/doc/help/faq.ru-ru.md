---
date: "2019-04-05T16:00:00+02:00"
title: "ЧАВО"
slug: "faq"
weight: 5
toc: true
draft: false
menu:
  sidebar:
    parent: "help"
    name: "ЧАВО"
    weight: 5
    identifier: "faq"
---

# Часто задаваемые вопросы

Эта страница содержит некоторые общие вопросы и ответы.  
См. также [Варианты поддержки]({{< relref "doc/help/seek-help.ru-ru.md" >}})

* [Разница между загрузками 1.x и 1.x.x](#разница-между-загрузками-1.x-и-1.x.x)
* [Как перейти с Gogs/GitHub/т.д. в Gitea](#как-перейти-с-gogs-github-т.д.-в-gitea)
* [Где Gitea хранит "x" файл](#где-gitea-хранит-x-файл)
* [URL-адрес клона не отображается или URL-адрес клона неверен](#url-адрес-клона-не-отображается-или-url-адрес-клона-неверен)
* [Пользовательские шаблоны не загружаются или работают неправильно](#пользовательские-шаблоны-не-загружаются-или-работают-неправильно)
* [Активный пользователь против входа в систему с запрещённым пользователем](#активный-пользователь-против-входа-в-систему-с-запрещённым-пользователем)
* [Настройка ведения журнала](#настройка-ведения-журнала)
* [Что такое Swagger?](#что-такое-swagger)
* [Настройка вашего сервера для публичного/частного использования](#настройка-вашего-сервера-для-публичного-частного-использования)
  * [Предотвращение спамеров](#предотвращение-спамеров)
  * [Разрешить только определённые почтовые домены](#разрешить-только-определённые-почтовые-домены)
  * [Разрешить/заблокировать только определённых провайдеров OpenID](#разрешить-заблокировать-только-определённых-провайдеров-openid)
  * [Только для пользователей с задачами](#только-для-пользователей-с-задачами)
  * [Ограниченные пользователи](#ограниченные-пользователи)
  * [Включить Fail2ban](#включить-fail2ban)
* [Как добавлять/использовать собственные темы](#как-добавлять-использовать-собственные-темы)
* [SSHD против встроенного SSH](#sshd-против-встроенного-ssh)
* [Gitea работает медленно](#gitea-работает-медленно)
* [Не могу создавать репозитории/файлы](#не-могу-создавать-репозитории-файлы)
* [Перевод неверный/как добавить больше переводов](#перевод-неверный-как-добавить-больше-переводов)
* [Hook'и не работают](#hook'и-не-работают)
* [Проблемы с SSH](#проблемы-с-ssh)
  * [Обычные ошибки SSH](#обычные-ошибки-ssh)
* [Отсутствуют релизы после переноса репозитория с тегами](#отсутствуют-релизы-после-переноса-репозитория-с-тегами)
* [Проблемы LFS](#проблемы-lfs)
* [Как мне создавать пользователей перед запуском Gitea](#как-мне-создавать-пользователей-перед-запуском-gitea)
* [Как включить сброс пароля](#как-включить-сброс-пароля)
* [Как можно изменить пароль пользователя](#как-можно-изменить-пароль-пользователя)
* [Почему у меня не работает markdown](#почему-у-меня-не-работает-markdown)


## Разница между загрузками 1.x и 1.x.x
В этом примере будет использоваться версия 1.7.x.  
**ПРИМЕЧАНИЕ:** этот пример применим и к изображениям Docker!  

На нашей [странице загрузок](https://dl.gitea.io/gitea/) вы увидите каталог 1.7, а также каталоги для 1.7.0, 1.7.1, 1.7.2, 1.7.3, 1.7. 4, 1.7.5 и 1.7.6.  
Каталоги 1.7 и 1.7.0 **не** одинаковы. Каталог 1.7 создается для каждого объединенного коммита в ветке [`release/v1.7`](https://github.com/go-gitea/gitea/tree/release/v1.7).  
Однако каталог 1.7.0 - это сборка, которая была создана при создании тега [`v1.7.0`](https://github.com/go-gitea/gitea/releases/tag/v1.7.0).  

Это означает, что загрузки 1.x будут меняться по мере того, как коммиты объединяются в их соответствующую ветку (воспринимайте это как отдельную "главную" ветку для каждого выпуска).  
С другой стороны, загрузки 1.x.x никогда не должны меняться.

## Как перейти с Gogs/GitHub/т.д. в Gitea
Чтобы перейти с Gogs на Gitea:

* [Gogs версии 0.9.146 или ниже]({{< relref "doc/upgrade/from-gogs.ru-ru.md" >}})
* [Версия Gogs 0.11.46.0418](https://github.com/go-gitea/gitea/issues/4286)

Чтобы перейти с GitHub на Gitea, вы можете использовать встроенную форму миграции Gitea. 
Чтобы перенести такие элементы, как проблемы, запросы на вытягивание и т.д., Вам нужно будет ввести как минимум свое имя пользователя.  
[Пример (требуется вход)](https://try.gitea.io/repo/migrate)

Чтобы перейти с Gitlab на Gitea, вы можете использовать этот неаффилированный инструмент:  
https://github.com/loganinak/MigrateGitlabToGogs

## Где Gitea хранит "x" файл
* WorkPath
  * Переменная окружения `GITEA_WORK_DIR`
  * Другое двоичное расположение
* AppDataPath (по умолчанию для базы данных, индексаторов и т.д.)
  * `APP_DATA_PATH` из `app.ini`
  * Ещё `%(WorkPath)/data`
* CustomPath (собственные шаблоны)
  * Переменная окружения `GITEA_CUSTOM`
  * Ещё `%(WorkPath)/custom`
* HomeDir
  * Unix: Переменная окружения `HOME`
  * Windows: Переменная среды `USERPROFILE`, иначе переменные среды `HOMEDRIVE`+`HOMEPATH`
* RepoRootPath
  * `ROOT` в `app.ini`
  * Ещё `%(HomeDir)/gitea-repositories`
* INI (файл конфигурации)
  * `-c` флаг
  * Ешё `%(CustomPath)/conf/app.ini`
* База данных SQLite  
  * `PATH` в разделе `database` в `app.ini`
  * Ешё `%(AppDataPath)/gitea.db`

## URL-адрес клона не отображается или URL-адрес клона неверен
Есть несколько мест, где оно может показываться неправильно.

1. При использовании обратного прокси-сервера убедитесь, что вы следовали указаниям по исправлению, приведенным в [руководстве по обратному прокси-серверу]({{< relref "doc/usage/reverse-proxies.ru-ru.md" >}})
2. Убедитесь, что вы правильно установили `ROOT_URL` в разделе `server` вашего `app.ini`

Если определенные параметры клонирования не отображаются (HTTP/S или SSH), следующие параметры можно проверить в вашем `app.ini`

`DISABLE_HTTP_GIT`: если установлено значение true, ссылка HTTP/HTTPS не будет  
`DISABLE_SSH`: если установлено значение true, ссылка SSH не будет  
`SSH_EXPOSE_ANONYMOUS`: если установлено значение false, ссылки SSH будут скрыты для анонимных пользователей  


## Пользовательские шаблоны не загружаются или работают неправильно
Пользовательские шаблоны Gitea должны быть добавлены в правильное место, иначе Gitea не сможет их найти и использовать.  
Правильный путь для шаблона(ов) будет относительно `CustomPath`

1. Чтобы найти `CustomPath`, ищите Custom File Root Path в Администрация сайта -> Конфигурация 
  * Если этого не существует, вы можете попробовать `echo $GITEA_CUSTOM`
2. Если вы всё ещё не можете найти путь, значение по умолчанию может быть [рассчитано выше](#где-gitea-хранит-"x"-файл)
3. После того, как вы выяснили правильный пользовательский путь, вы можете обратиться к странице по [настройке Gitea]({{< relref "doc/advanced/customizing-gitea.ru-ru.md" >}}), чтобы добавить шаблон в нужное место.

## Активный пользователь против входа в систему с запрещённым пользователем
В Gitea "активный" пользователь относится к пользователю, который активировал свою учётную запись по электронной почте.  
Пользователь с "запрещенным входом" - это пользователь, которому больше не разрешено входить в Gitea.

## Настройка ведения журнала 
* [Официальная документация]({{< relref "doc/advanced/logging-documentation.ru-ru.md" >}})

## Что такое Swagger?
[Swagger](https://swagger.io/) это то, что Gitea использует для своего API.  
Все экземпляры Gitea имеют встроенный API, хотя его можно отключить, установив для параметра `ENABLE_SWAGGER` значение `false` в разделе `api` файла `app.ini`.
Для получения дополнительной информации см. Gitea. [документацию API]({{< relref "doc/advanced/api-usage.en-us.md" >}})

[Примерный Swagger](https://try.gitea.io/api/swagger)

## Настройка вашего сервера для публичного/частного использования

### Предотвращение спамеров
Есть несколько вещей, которые вы можете комбинировать для предотвращения спамеров. 

1. Добавляя в белый список только определённые домены с OpenID (см. ниже)
2. Установка `ENABLE_CAPTCHA` в значение `true` в вашем `app.ini` и правильная настройка `RECAPTCHA_SECRET` и `RECAPTCHA_SITEKEY`
3. Установите для параметра `DISABLE_REGISTRATION` значение `true` и создание новых пользователей через [CLI]({{< relref "doc/usage/command-line.ru-ru.md" >}}), [API]({{< relref "doc/advanced/api-usage.ru-ru.md" >}}), или пользовательский интерфейс администратора Gitea  

### Разрешить только определённые почтовые домены
Вы можете настроить `EMAIL_DOMAIN_WHITELIST` в своём app.ini в разделе `[service]`

### Разрешить/заблокировать только определённых провайдеров OpenID
Вы можете настроить `WHITELISTED_URIS` или `BLACKLISTED_URIS` в разделе `[openid]` в вашем `app.ini`  
**ПРИМЕЧАНИЕ:** белый список имеет приоритет, поэтому, если он не пустой, то чёрный список игнорируется

### Только для пользователей с задачами
Текущий способ добиться этого - создать/изменить пользователя с максимальным лимитом создания репо, равным 0.

### Ограниченные пользователи
Пользователи с ограниченным доступом ограничены подмножеством контента на основе членства в их организации/команде и сотрудничества, игнорируя публичный флаг на организациях / репозиториях и т.д.__

Пример использования: компания запускает экземпляр Gitea, требующий входа в систему. Большинство репозиториев общедоступны (доступны/просматриваются всеми сотрудниками).

В какой-то момент клиенту или третьей стороне требуется доступ к определенному репо и только к этому репо. Ограничение такой учетной записи клиента и предоставление любого необходимого доступа с использованием членства в команде и/или совместной работы - это простой способ добиться этого без необходимости делать всё конфиденциальным.


### Включить Fail2ban

Используйте [Fail2Ban]({{ relref "doc/usage/fail2ban-setup.ru-ru.md" >}}) для отслеживания и остановки автоматических попыток входа в систему или другого злонамеренного поведения на основе шаблонов журналов

## Как добавлять/использовать собственные темы
На данный момент Gitea поддерживает две официальные темы: `gitea` и `arc-green` (`light` и `dark` соответственно).  
Чтобы добавить свою собственную тему, в настоящее время единственный способ - предоставить полную тему (а не только замену цвета)  
  
В качестве примера предположим, что наша тема - `arc-blue` (это настоящая тема, и её можно найти [в этом issue](https://github.com/go-gitea/gitea/issues/6011))  
Назовите файл `.css` - `theme-arc-blue.css` и добавьте его в свою пользовательскую папку в `custom/pulic/css`  
Разрешите пользователям использовать его, добавив `arc-blue` в список `THEMES` в вашем `app.ini`

## SSHD против встроенного SSH
SSHD - это встроенный SSH-сервер в большинстве систем Unix.  
Gitea также предоставляет собственный SSH-сервер для использования, когда SSHD недоступен.

## Gitea работает медленно
Наиболее частая причина этого - загрузка федеративных аватаров.  
Это можно отключить, установив для параметра `ENABLE_FEDERATED_AVATAR` значение на `false` в `app.ini`  
Другой вариант, который может потребоваться изменить, - это установить для параметра `DISABLE_GRAVATAR` значение `true` в  `app.ini`

## Не могу создавать репозитории/файлы
Убедитесь, что у Gitea достаточно прав для записи в свой домашний каталог и каталог данных.  
Обратитесь [AppDataPath и RepoRootPath](#где-gitea-хранит-x-файл)

**Примечание для пользователей Arch:** На момент написания этой статьи возникла проблема с файлом systemd пакета Arch, содержащим эту строку:
`ReadWritePaths=/etc/gitea/app.ini`  
Это делает все остальные пути недоступными для записи в Gitea.

## Перевод неверный/как добавить больше переводов
В настоящее время наши переводы собраны на нашем [Crowdin project](https://crowdin.com/project/gitea)  
Если вы хотите изменить перевод или добавить новый, он должен быть там, так как все переводы перезаписываются в нашем CI через интеграцию Crowdin.

## Hook'и не работают
Если Gitea не запускает хуки, распространенной причиной является неправильная установка ключей SSH.  
Обратитесь к [Проблемы с SSH](#проблемы-с-ssh), чтобы получить больше информации.  
  
Вы также можете попробовать войти в панель администрирования и запустить опцию `Повторная синхронизация hook'ов pre-receive, update и post-receive во всех репозиториях.`.

## Проблемы с SSH
Если вы не можете получить доступ к репозиториям через `ssh`, но `https` работает нормально, подумайте о следующем.

Во-первых, убедитесь, что вы можете получить доступ к Gitea через SSH.  
`ssh git@myremote.example`  

Если соединение успешно, вы должны получить сообщение об ошибке, подобное следующему:
```
Hi there, You've successfully authenticated, but Gitea does not provide shell access.
If this is unexpected, please log in with password and setup Gitea under another user.
```

Если вы не получили указанное выше сообщение, но всё ещё подключаетесь, это означает, что ваш SSH-ключ **не** управляется Gitea. Это означает, что hook'и не будут работать, помимо других потенциальных проблем.

Если вы вообще не можете подключиться, возможно, ваш SSH-ключ настроен неправильно локально.
Это относится к SSH, а не к Gitea, поэтому здесь не рассматривается.

### Обычные ошибки SSH

```
Permission denied (publickey).
fatal: Could not read from remote repository.
```

Эта ошибка означает, что сервер отклонил попытку входа в систему,
проверьте следующее:

* На клиенте:
  * Убедитесь, что открытый и закрытый ключи ssh добавлены правильному пользователю Gitea.
  * Убедитесь, что с удалённым URL-адресом нет проблем. В частности, убедитесь, что имя
    пользователя git (до `@`) написано правильно.
  * Убедитесь, что открытый и закрытый ключи ssh указаны правильно на клиентском компьютере.
* На сервере:
  * Убедитесь, что репозиторий существует и правильно назван.
  * Проверьте права доступа к каталогу `.ssh` в домашнем каталоге пользователя системы.
  * Убедитесь, что правильные открытые ключи добавлены в `.ssh/authorized_keys`.  
    Попробуйте запустить `Rewrite '.ssh/authorized_keys' file (для ключей Gitea SSH)` на панели
	администратора Gitea.
  * Прочтите журналы(logs) Gitea.
  * Прочтите /var/log/auth (или аналогичный).
  * Проверьте разрешения репозиториев.

Ниже приведен пример отсутствия общедоступного ключа SSH при успешной аутентификации,
но некоторые другие настройки не позволяют SSH достичь правильного репозитория.

```
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
```

В этом случае посмотрите следующие настройки:

* На сервере:
  * Убедитесь, что у системного пользователя `git` есть рабочий набор команд
    * Проверьте это с помощью `getent passwd git | cut -d: -f7`
    * `usermod` или `chsh` можно использовать, чтобы изменить это.
  * Убедитесь, что `gitea serv` команда в `.ssh/authorized_keys` использует
    правильный файл конфигурации.

## Отсутствуют релизы после переноса репозитория с тегами

Чтобы мигрировать репозиторий *со* всеми тегами, вам нужно сделать две вещи:

* Перенести теги в репозиторий:
```
 git push --tags
 ```
 
 * (Повторно)синхронизировать теги всех репозиториев в Gitea:
 ```
 gitea admin repo-sync-releases
 ```

## Проблемы LFS

По вопросам, связанным с загрузкой данных LFS

```
batch response: Authentication required: Authorization error: <GITEA_LFS_URL>/info/lfs/objects/batch                                                                                                              
Check that you have proper access to the repository
error: failed to push some refs to '<GIT_REPO_URL>'
```
Проверьте значение `LFS_HTTP_AUTH_EXPIRY` в вашем файле `app.ini`.  
По умолчанию срок действия вашего токена LFS истекает через 20 минут. Если у вас медленное соединение или большой файл (или оба), загрузка может не завершиться в отведённое время.

Вы можете установить это значение на `60m` или `120m`.

## Как мне создавать пользователей перед запуском Gitea
Gitea предоставляет подкоманду gitea migrate для инициализации базы данных, после чего вы можете использовать [команды CLI администратора]({{< relref "doc/usage/command-line.ru-ru.md#админ" >}}), чтобы добавлять пользователей как обычно.

## Как включить сброс пароля
Нет настройки для сброса пароля. Он включен, когда [почтовый сервис]({{< relref "doc/usage/email-setup.ru-ru.md" >}}) настроен и отключен в противном случае.

## Как можно изменить пароль пользователя
- Как **администратор**, вы можете изменить пароль любого пользователя (и при необходимости заставить его изменить его при следующем входе в систему)...
  - Перейдя на страницу `Администрирование сайта -> Учётные записи пользователей` и отредактировав имя пользователя.  
  - Используя [команды CLI администратора]]({{< relref "doc/usage/command-line.ru-ru.md#admin" >}}).  
  Имейте в виду, что для большинства команд также потребуется [глобальные параметры]({{< relref "doc/usage/command-line.ru-ru.md#глобальные-параметры" >}}), чтобы указать CLI на правильную конфигурацию.
- Как **пользователь** вы можете изменить его... 
  - На странице `Настройки -> Учётная запись` вашей учетной записи (этот метод **требует**, чтобы вы знали текущий пароль).
  - По ссылке `Забыл пароль`.  
   Если страница `Забыли пароль/восстановление учётной записи` отключена, обратитесь к администратору, чтобы настроить [почтовую службу]({{< relref "doc/usage/email-setup.ru-ru.md" >}}).
   
## Почему у меня не работает markdown
В версии Gitea `1.11` мы перешли на [goldmark](https://github.com/yuin/goldmark) для рендеринга markdown, который поддаётся [CommonMark](https://commonmark.org/).  
Если у вас есть уценка, которая работала так, как вы ожидали до версии `1.11`, а после обновления она больше не работает, просмотрите спецификацию CommonMark, чтобы узнать, связана ли проблема с ошибкой или несовместимым синтаксисом.  
Если это последнее, _ обычно_ есть соответствующая альтернатива, указанная в спецификации.
